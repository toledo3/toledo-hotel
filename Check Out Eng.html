<html> 
<head>
<title>Toledo Guests Check Out</title>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body {
  background-color:;
    position:initial;
    }
</style>
</head>
<body  style="border-style:double ; border-width:3" onload=" ">
<br>
<center><a href="https://toledohotel.jo"><img src="logo.png" width="160px" height="55px"></a>
<br>
  <table border="0">
    <br>
    <tr>
      <td align="center">
    <script language="javascript">
var today = new Date();
document.write(today);
</script>
      </td>
  </tr>
<tr>
<td colspan="2" align="center"><font size="5" face="times new romans" color=""><b>Check Out</b></font></td></center>
  </tr>
</table>
<br>
<br>
<font size="3" face="times new romans" color="">Dear guest..</font>
<br>
<br>
<font size="3" color="" face="times new romans">We were pleased with your stay at Toledo Hotel!</font>
<br>
<font size="3" color="" face="times new romans">If you would like to check out, please confirm the following : </font>
<br>
<form id="mG61Hd" onsubmit=" "  name="form" action="https://script.google.com/macros/s/AKfycbworzBrIP6ZgEzmnC6MMq5xkIDe51Qp3FUgQiVXfoLUS-cXSsPJvZKbrYru-JO1c69qSQ/exec " target="_self"  method="POST">
<table border="0">
<tr>
  <td> Timestamp</td>
<td><input type="datetime-local" id="datetimeField" name="currentTime"></td>
</tr>
  <tr>
<td>Room :</td>
<td><input id="Room" type="number" name="Room" value=""></td>
</tr>
<tr>
<td>Name :</td>
<td><input id="Name" type="text" name="Name" value=""></td>
</tr>
<tr>
<td>Check Out Date</td>
 <td><input id="Check In Date" type="date" name="Out Date" value=""></td>
</tr>
<tr>
<td>Check Out Time</td>
<td><input id="Check Out Time" type="time" name="Out Time" value=""></td>
</tr>
<br>
<br>
<tr>
<td align="center"></td>
<td align="center">Yes</td>
<td align="left">No</td>
</tr>
<tr>
<td>A taxi for the airport.</td>
<td align="center"><input id="Yes" type="radio" name="Taxi" value ="Yes"></td>
<td align="left"><input id="No" type="radio" name="Taxi" value ="No"></td>
</tr>
  <tr>
<td>Bell Boy is required.</td>
<td align="center"><input id="Yes" type="radio" name="Bell Boy" value ="Yes"></td>
<td align="left"><input id="No" type="radio" name="Bell Boy" value ="No"></td>
</tr>
<tr>
<td><u>MiniBar</u></td>
</tr>
<table align=" " border="0">
<tr>
<td align="center"><u><b>Item</b></u></td>
<td align="center"><u><b>QTY</b></u></td>
<td align="center"></td>
</tr>
<tr>
<td align=" ">Soft Drinks</td>
<td align="center"><input id="Soft Drinks" type="number" name="Soft Drinks"  placeholder="Cola,Fanta,Sprite"></td>
</tr>
<tr>
<td align=" ">Sparking Water</td>
<td align="center"><input id="Sparking Water" type="number" name="Sparking Water"  value =" " ></td>
</tr>
<tr>
<td align=" ">Miniral Water</td>
<td align="center"><input  id="Miniral Water" type="number" name="Miniral Water"  value =" " ></td>
</tr>
<tr>
<td align=" ">Chocolate</td>
<td align="center"><input id="Chocolate" type="number" name="Chocolate"  value =" " ></td>
</tr>
<tr>
<td align=" ">Nuts</td>
<td align="center"><input id="Nuts" type="number" name="Nuts"  value =" " ></td>
</tr>
<tr>
<td align=" ">Chips</td>
<td align="center"><input id="Chips" type="number" name="Chips"   value =" " ></td>
</tr>
</table>
<center>
  <table border="0">
    <tr>
      <td></td>
    </tr>
  </table>
  <table border="0">
        <tr>
      <td>Is there any thing else we can help you?</td>
    </tr>
  </table>
<textarea wrap="virtual" name="Comments" rows="3" cols="40" maxlength="100" placeholder="" >
</textarea>
<br>
<br>
<br> 
<input type="submit" value="Submit" onclick=" ">
<input type="Reset" value="Clear">
  </form>
  </center>
      <script>
      function handleFormSubmit(event) {
       event.preventDefault(); // Prevent form submission
       const datetimeValue = document.getElementById('datetimeField').value;
       const datetime = new Date(datetimeValue);
       const rowData = [
          [datetime.toLocaleString()] // Convert the date to a localized string
        ];
       gapi.client.sheets.spreadsheets.values.append({
          spreadsheetId: 'YOUR_SPREADSHEET_ID',
          range: 'Sheet1!A1', // Specify the range where you want to append the data
          valueInputOption: 'USER_ENTERED',
          resource: {
            values: rowData
          }
        }).then(function(response) {
          console.log('Data appended successfully!');
        }, function(error) {
          console.error('Error appending data:', error.result.error.message);
        });
      }

      // Load the Google Sheets API
      function loadSheetsAPI() {
        gapi.client.load('sheets', 'v4', function() {
          console.log('Google Sheets API loaded.');
        });
      }

      // Initialize the API client and set up the event listener
      function initClient() {
        gapi.client.init({
          apiKey: 'YOUR_API_KEY', // Your API key
          clientId: 'YOUR_CLIENT_ID', // Your OAuth 2.0 client ID
          discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
          scope: 'https://www.googleapis.com/auth/spreadsheets'
        }).then(function() {
          loadSheetsAPI();
        }, function(error) {
          console.error('Error initializing Google Sheets API:', error);
        });
      }

      // Authenticate and initialize the API client
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      // Attach the form submit event handler
      document.getElementById('myForm').addEventListener('submit', handleFormSubmit);

    </script>


</body>
</html>
